<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CinemaBooking - Thanh To√°n</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="gradient-bg text-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <h1 class="text-2xl font-bold">üé¨ CinemaBooking</h1>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="index.html" class="nav-link px-3 py-2 rounded-md text-sm font-medium hover:bg-white hover:bg-opacity-20 transition-colors">Trang Ch·ªß</a>
                        <a href="movies.html" class="nav-link px-3 py-2 rounded-md text-sm font-medium hover:bg-white hover:bg-opacity-20 transition-colors">Phim</a>
                        <a href="booking.html" class="nav-link px-3 py-2 rounded-md text-sm font-medium hover:bg-white hover:bg-opacity-20 transition-colors">ƒê·∫∑t V√©</a>
                        <a href="history.html" class="nav-link px-3 py-2 rounded-md text-sm font-medium hover:bg-white hover:bg-opacity-20 transition-colors">L·ªãch S·ª≠</a>
                        <a href="admin.html" class="nav-link px-3 py-2 rounded-md text-sm font-medium hover:bg-white hover:bg-opacity-20 transition-colors">Qu·∫£n Tr·ªã</a>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <button onclick="showLoginModal()" class="bg-white text-purple-600 px-4 py-2 rounded-lg font-medium hover:bg-gray-100 transition-colors">ƒêƒÉng Nh·∫≠p</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <h2 class="text-3xl font-bold mb-6 scroll-animate-left">Thanh To√°n</h2>
        
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Payment Form -->
            <div class="bg-white rounded-xl shadow-md p-6 scroll-animate-left">
                <h3 class="text-xl font-bold mb-4">Th√¥ng Tin Thanh To√°n</h3>
                <form id="payment-form" onsubmit="processPayment(event)" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">H·ªç v√† t√™n</label>
                        <input type="text" placeholder="Nh·∫≠p h·ªç v√† t√™n" class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" required>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                        <input type="email" placeholder="Nh·∫≠p email" class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" required>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">S·ªë ƒëi·ªán tho·∫°i</label>
                        <input type="tel" placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i" class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" required>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Ph∆∞∆°ng th·ª©c thanh to√°n</label>
                        <select class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" required>
                            <option value="">Ch·ªçn ph∆∞∆°ng th·ª©c</option>
                            <option value="credit">Th·∫ª t√≠n d·ª•ng/ghi n·ª£</option>
                            <option value="momo">V√≠ MoMo</option>
                            <option value="zalopay">ZaloPay</option>
                            <option value="banking">Chuy·ªÉn kho·∫£n ng√¢n h√†ng</option>
                        </select>
                    </div>
                    
                    <div id="card-details" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">S·ªë th·∫ª</label>
                            <input type="text" placeholder="1234 5678 9012 3456" class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" maxlength="19">
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Ng√†y h·∫øt h·∫°n</label>
                                <input type="text" placeholder="MM/YY" class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" maxlength="5">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">CVV</label>
                                <input type="text" placeholder="123" class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" maxlength="3">
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex items-center">
                        <input type="checkbox" id="terms" class="mr-2" required>
                        <label for="terms" class="text-sm text-gray-600">T√¥i ƒë·ªìng √Ω v·ªõi <a href="#" class="text-purple-600 hover:underline">ƒëi·ªÅu kho·∫£n s·ª≠ d·ª•ng</a></label>
                    </div>
                    
                    <button type="submit" class="w-full bg-purple-600 text-white py-3 rounded-lg font-semibold hover:bg-purple-700 transition-colors">
                        Thanh To√°n Ngay
                    </button>
                </form>
            </div>
            
            <!-- Order Summary -->
            <div class="bg-white rounded-xl shadow-md p-6 scroll-animate-right">
                <h3 class="text-xl font-bold mb-4">Chi Ti·∫øt ƒê∆°n H√†ng</h3>
                <div id="payment-summary" class="space-y-4">
                    <!-- Payment summary will be loaded here -->
                </div>
                
                <div class="border-t pt-4 mt-6">
                    <div class="space-y-2">
                        <div class="flex justify-between">
                            <span>T·∫°m t√≠nh:</span>
                            <span id="subtotal">0 VNƒê</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Ph√≠ d·ªãch v·ª•:</span>
                            <span id="service-fee">10,000 VNƒê</span>
                        </div>
                        <div class="flex justify-between text-lg font-bold border-t pt-2">
                            <span>T·ªïng c·ªông:</span>
                            <span id="final-total" class="text-purple-600">0 VNƒê</span>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 p-4 bg-gray-50 rounded-lg">
                    <h4 class="font-semibold mb-2">üé´ L∆∞u √Ω quan tr·ªçng:</h4>
                    <ul class="text-sm text-gray-600 space-y-1">
                        <li>‚Ä¢ V√© ƒë√£ mua kh√¥ng th·ªÉ ƒë·ªïi tr·∫£</li>
                        <li>‚Ä¢ Vui l√≤ng c√≥ m·∫∑t tr∆∞·ªõc gi·ªù chi·∫øu 15 ph√∫t</li>
                        <li>‚Ä¢ Mang theo CMND/CCCD khi ƒë·∫øn r·∫°p</li>
                        <li>‚Ä¢ V√© s·∫Ω ƒë∆∞·ª£c g·ª≠i qua email sau khi thanh to√°n</li>
                    </ul>
                </div>
            </div>
        </div>
    </main>

    <!-- Login Modal -->
    <div id="login-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold">ƒêƒÉng Nh·∫≠p</h3>
                <button onclick="hideLoginModal()" class="text-gray-500 hover:text-gray-700">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <form onsubmit="login(event)" class="space-y-4">
                <input type="email" placeholder="Email" class="w-full px-4 py-3 border rounded-lg" required>
                <input type="password" placeholder="M·∫≠t kh·∫©u" class="w-full px-4 py-3 border rounded-lg" required>
                <button type="submit" class="w-full bg-purple-600 text-white py-3 rounded-lg font-semibold hover:bg-purple-700 transition-colors">ƒêƒÉng Nh·∫≠p</button>
            </form>
            <div class="text-center mt-4">
                <a href="#" class="text-purple-600 hover:underline">Ch∆∞a c√≥ t√†i kho·∫£n? ƒêƒÉng k√Ω ngay</a>
            </div>
        </div>
    </div>

    <script src="data.js"></script>
    <script src="common.js"></script>
    <script>
        let currentBooking = null;

        // Load payment page
        function loadPaymentPage() {
            const bookingData = localStorage.getItem('currentBooking');
            if (!bookingData) {
                alert('Kh√¥ng t√¨m th·∫•y th√¥ng tin ƒë·∫∑t v√©!');
                window.location.href = 'booking.html';
                return;
            }

            currentBooking = JSON.parse(bookingData);
            
            const summaryDiv = document.getElementById('payment-summary');
            const subtotalDiv = document.getElementById('subtotal');
            const finalTotalDiv = document.getElementById('final-total');
            
            const serviceFee = 10000;
            const subtotal = currentBooking.total;
            const finalTotal = subtotal + serviceFee;
            
            summaryDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="flex items-center space-x-3">
                        <div class="text-4xl">${currentBooking.movie.poster}</div>
                        <div>
                            <h4 class="font-bold">${currentBooking.movie.title}</h4>
                            <p class="text-gray-600 text-sm">${currentBooking.movie.duration} ph√∫t</p>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div>
                                <span class="text-gray-500">Su·∫•t chi·∫øu:</span>
                                <div class="font-medium">${currentBooking.showtime}</div>
                            </div>
                            <div>
                                <span class="text-gray-500">Ng√†y chi·∫øu:</span>
                                <div class="font-medium">${new Date().toLocaleDateString('vi-VN')}</div>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <span class="text-gray-500 text-sm">Gh·∫ø ƒë√£ ch·ªçn:</span>
                        <div class="font-medium">${currentBooking.seats.join(', ')}</div>
                    </div>
                    
                    <div class="flex justify-between">
                        <span>S·ªë l∆∞·ª£ng v√©:</span>
                        <span class="font-medium">${currentBooking.seats.length} v√©</span>
                    </div>
                    
                    <div class="flex justify-between">
                        <span>Gi√° m·ªói v√©:</span>
                        <span class="font-medium">${formatCurrency(currentBooking.movie.price)}</span>
                    </div>
                </div>
            `;
            
            subtotalDiv.textContent = formatCurrency(subtotal);
            finalTotalDiv.textContent = formatCurrency(finalTotal);
        }

        // Process payment
        function processPayment(event) {
            event.preventDefault();
            
            const submitBtn = event.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'ƒêang x·ª≠ l√Ω...';
            submitBtn.disabled = true;
            
            setTimeout(() => {
                const booking = {
                    id: generateBookingId(),
                    movie: currentBooking.movie.title,
                    showtime: currentBooking.showtime,
                    seats: [...currentBooking.seats],
                    total: currentBooking.total + 10000, // Include service fee
                    date: new Date().toLocaleDateString('vi-VN'),
                    status: 'ƒê√£ thanh to√°n',
                    paymentMethod: event.target.querySelector('select').value,
                    customerName: event.target.querySelector('input[type="text"]').value,
                    customerEmail: event.target.querySelector('input[type="email"]').value,
                    customerPhone: event.target.querySelector('input[type="tel"]').value
                };
                
                bookingHistory.push(booking);
                saveBookingHistory();
                
                showPaymentSuccess(booking);
                
                localStorage.removeItem('currentBooking');
                
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
                event.target.reset();
                
            }, 2000);
        }

        // Show payment success
        function showPaymentSuccess(booking) {
            const successModal = document.createElement('div');
            successModal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            successModal.innerHTML = `
                <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 text-center">
                    <div class="text-6xl mb-4">‚úÖ</div>
                    <h3 class="text-2xl font-bold mb-4 text-green-600">Thanh To√°n Th√†nh C√¥ng!</h3>
                    <div class="space-y-2 text-left mb-6">
                        <div><strong>M√£ ƒë·∫∑t v√©:</strong> ${booking.id}</div>
                        <div><strong>Phim:</strong> ${booking.movie}</div>
                        <div><strong>Su·∫•t chi·∫øu:</strong> ${booking.showtime}</div>
                        <div><strong>Gh·∫ø:</strong> ${booking.seats.join(', ')}</div>
                        <div><strong>T·ªïng ti·ªÅn:</strong> ${formatCurrency(booking.total)}</div>
                    </div>
                    <p class="text-gray-600 text-sm mb-6">
                        V√© ƒëi·ªán t·ª≠ ƒë√£ ƒë∆∞·ª£c g·ª≠i ƒë·∫øn email c·ªßa b·∫°n. Vui l√≤ng ki·ªÉm tra h·ªôp th∆∞!
                    </p>
                    <div class="space-y-2">
                        <button onclick="window.location.href='history.html'" 
                                class="w-full bg-purple-600 text-white py-2 rounded-lg hover:bg-purple-700 transition-colors">
                            Xem L·ªãch S·ª≠ ƒê·∫∑t V√©
                        </button>
                        <button onclick="window.location.href='index.html'" 
                                class="w-full bg-gray-200 text-gray-800 py-2 rounded-lg hover:bg-gray-300 transition-colors">
                            V·ªÅ Trang Ch·ªß
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(successModal);
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            loadPaymentPage();
        });
    </script>
</body>
</html>