<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CinemaBooking - Qu·∫£n Tr·ªã</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="gradient-bg text-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <h1 class="text-2xl font-bold">üé¨ CinemaBooking</h1>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="index.html" class="nav-link px-3 py-2 rounded-md text-sm font-medium hover:bg-white hover:bg-opacity-20 transition-colors">Trang Ch·ªß</a>
                        <a href="movies.html" class="nav-link px-3 py-2 rounded-md text-sm font-medium hover:bg-white hover:bg-opacity-20 transition-colors">Phim</a>
                        <a href="booking.html" class="nav-link px-3 py-2 rounded-md text-sm font-medium hover:bg-white hover:bg-opacity-20 transition-colors">ƒê·∫∑t V√©</a>
                        <a href="history.html" class="nav-link px-3 py-2 rounded-md text-sm font-medium hover:bg-white hover:bg-opacity-20 transition-colors">L·ªãch S·ª≠</a>
                        <a href="admin.html" class="nav-link px-3 py-2 rounded-md text-sm font-medium bg-white bg-opacity-20">Qu·∫£n Tr·ªã</a>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <button onclick="showLoginModal()" class="bg-white text-purple-600 px-4 py-2 rounded-lg font-medium hover:bg-gray-100 transition-colors">ƒêƒÉng Nh·∫≠p</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <h2 class="text-3xl font-bold mb-6">Trang Qu·∫£n Tr·ªã</h2>
        
        <!-- Statistics Cards -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="bg-white rounded-xl shadow-md p-6 text-center scroll-animate">
                <div class="text-3xl font-bold text-purple-600 mb-2" id="total-revenue">0 VNƒê</div>
                <div class="text-gray-600">Doanh thu h√¥m nay</div>
            </div>
            <div class="bg-white rounded-xl shadow-md p-6 text-center scroll-animate">
                <div class="text-3xl font-bold text-blue-600 mb-2" id="tickets-sold">0</div>
                <div class="text-gray-600">V√© ƒë√£ b√°n</div>
            </div>
            <div class="bg-white rounded-xl shadow-md p-6 text-center scroll-animate">
                <div class="text-3xl font-bold text-green-600 mb-2" id="total-movies">${movies.length}</div>
                <div class="text-gray-600">T·ªïng s·ªë phim</div>
            </div>
            <div class="bg-white rounded-xl shadow-md p-6 text-center scroll-animate">
                <div class="text-3xl font-bold text-orange-600 mb-2" id="occupancy-rate">0%</div>
                <div class="text-gray-600">T·ª∑ l·ªá l·∫•p ƒë·∫ßy</div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Movie Management -->
            <div class="bg-white rounded-xl shadow-md p-6 scroll-animate-left">
                <h3 class="text-xl font-bold mb-4">Qu·∫£n L√Ω Phim</h3>
                <form onsubmit="addMovie(event)" class="space-y-4">
                    <input type="text" name="title" placeholder="T√™n phim" class="w-full px-4 py-2 border rounded-lg" required>
                    <select name="genre" class="w-full px-4 py-2 border rounded-lg" required>
                        <option value="">Ch·ªçn th·ªÉ lo·∫°i</option>
                        <option value="action">H√†nh ƒë·ªông</option>
                        <option value="comedy">H√†i k·ªãch</option>
                        <option value="drama">Ch√≠nh k·ªãch</option>
                        <option value="horror">Kinh d·ªã</option>
                    </select>
                    <input type="number" name="duration" placeholder="Th·ªùi l∆∞·ª£ng (ph√∫t)" class="w-full px-4 py-2 border rounded-lg" required>
                    <input type="number" name="price" placeholder="Gi√° v√© (VNƒê)" class="w-full px-4 py-2 border rounded-lg" required>
                    <textarea name="description" placeholder="M√¥ t·∫£ phim" class="w-full px-4 py-2 border rounded-lg h-20" required></textarea>
                    <button type="submit" class="w-full bg-purple-600 text-white py-2 rounded-lg hover:bg-purple-700 transition-colors">Th√™m Phim</button>
                </form>
            </div>

            <!-- Recent Bookings -->
            <div class="bg-white rounded-xl shadow-md p-6 scroll-animate-right">
                <h3 class="text-xl font-bold mb-4">ƒê·∫∑t V√© G·∫ßn ƒê√¢y</h3>
                <div id="recent-bookings" class="space-y-3">
                    <!-- Recent bookings will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Movie List Management -->
        <div class="bg-white rounded-xl shadow-md p-6 mt-8 scroll-animate">
            <h3 class="text-xl font-bold mb-4">Danh S√°ch Phim Hi·ªán T·∫°i</h3>
            <div class="overflow-x-auto">
                <table class="w-full table-auto">
                    <thead>
                        <tr class="bg-gray-50">
                            <th class="px-4 py-2 text-left">T√™n Phim</th>
                            <th class="px-4 py-2 text-left">Th·ªÉ Lo·∫°i</th>
                            <th class="px-4 py-2 text-left">Th·ªùi L∆∞·ª£ng</th>
                            <th class="px-4 py-2 text-left">Gi√° V√©</th>
                            <th class="px-4 py-2 text-left">Thao T√°c</th>
                        </tr>
                    </thead>
                    <tbody id="admin-movies-list">
                        <!-- Movies will be loaded here -->
                    </tbody>
                </table>
            </div>
        </div>
    </main>

    <!-- Login Modal -->
    <div id="login-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold">ƒêƒÉng Nh·∫≠p</h3>
                <button onclick="hideLoginModal()" class="text-gray-500 hover:text-gray-700">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <form onsubmit="login(event)" class="space-y-4">
                <input type="email" placeholder="Email" class="w-full px-4 py-3 border rounded-lg" required>
                <input type="password" placeholder="M·∫≠t kh·∫©u" class="w-full px-4 py-3 border rounded-lg" required>
                <button type="submit" class="w-full bg-purple-600 text-white py-3 rounded-lg font-semibold hover:bg-purple-700 transition-colors">ƒêƒÉng Nh·∫≠p</button>
            </form>
            <div class="text-center mt-4">
                <a href="#" class="text-purple-600 hover:underline">Ch∆∞a c√≥ t√†i kho·∫£n? ƒêƒÉng k√Ω ngay</a>
            </div>
        </div>
    </div>

    <script src="data.js"></script>
    <script src="common.js"></script>
    <script>
        // Load admin statistics
        function loadAdminStats() {
            const totalRevenue = bookingHistory.reduce((sum, booking) => sum + booking.total, 0);
            const ticketsSold = bookingHistory.reduce((sum, booking) => sum + booking.seats.length, 0);
            const occupancyRate = Math.round((ticketsSold / (150 * 4)) * 100); // 150 seats, 4 showtimes
            
            document.getElementById('total-revenue').textContent = formatCurrency(totalRevenue);
            document.getElementById('tickets-sold').textContent = ticketsSold;
            document.getElementById('occupancy-rate').textContent = occupancyRate + '%';
        }

        // Load recent bookings
        function loadRecentBookings() {
            const container = document.getElementById('recent-bookings');
            const recentBookings = bookingHistory.slice(-5).reverse();
            
            if (recentBookings.length === 0) {
                container.innerHTML = '<div class="text-gray-500 text-center py-4">Ch∆∞a c√≥ ƒë·∫∑t v√© n√†o</div>';
                return;
            }
            
            container.innerHTML = recentBookings.map(booking => `
                <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                    <div>
                        <div class="font-medium">${booking.movie}</div>
                        <div class="text-sm text-gray-600">${booking.customerName} - ${booking.seats.length} v√©</div>
                    </div>
                    <div class="text-right">
                        <div class="font-medium text-green-600">${formatCurrency(booking.total)}</div>
                        <div class="text-sm text-gray-600">${booking.date}</div>
                    </div>
                </div>
            `).join('');
        }

        // Load admin movies list
        function loadAdminMoviesList() {
            const container = document.getElementById('admin-movies-list');
            container.innerHTML = movies.map(movie => `
                <tr class="border-b hover:bg-gray-50">
                    <td class="px-4 py-3">${movie.title}</td>
                    <td class="px-4 py-3 capitalize">${movie.genre}</td>
                    <td class="px-4 py-3">${movie.duration} ph√∫t</td>
                    <td class="px-4 py-3">${formatCurrency(movie.price)}</td>
                    <td class="px-4 py-3">
                        <button onclick="editMovie(${movie.id})" class="text-blue-600 hover:underline mr-2">S·ª≠a</button>
                        <button onclick="deleteMovie(${movie.id})" class="text-red-600 hover:underline">X√≥a</button>
                    </td>
                </tr>
            `).join('');
        }

        // Add movie
        function addMovie(event) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);
            
            const newMovie = {
                id: Math.max(...movies.map(m => m.id)) + 1,
                title: formData.get('title'),
                genre: formData.get('genre'),
                duration: parseInt(formData.get('duration')),
                price: parseInt(formData.get('price')),
                description: formData.get('description'),
                poster: getRandomPoster(),
                showtimes: ["10:00", "13:30", "16:45", "20:00"]
            };
            
            movies.push(newMovie);
            form.reset();
            loadAdminMoviesList();
            document.getElementById('total-movies').textContent = movies.length;
            showSuccessModal('Th√†nh c√¥ng!', 'Phim m·ªõi ƒë√£ ƒë∆∞·ª£c th√™m v√†o h·ªá th·ªëng.');
        }

        // Get random poster emoji
        function getRandomPoster() {
            const posters = ['üé¨', 'üé≠', 'üé™', 'üé®', 'üéØ', 'üé≤', 'üé∏', 'üé∫', 'üéª', 'üé§'];
            return posters[Math.floor(Math.random() * posters.length)];
        }

        // Edit movie
        function editMovie(movieId) {
            const movie = movies.find(m => m.id === movieId);
            if (movie) {
                const newTitle = prompt('T√™n phim m·ªõi:', movie.title);
                if (newTitle && newTitle.trim()) {
                    movie.title = newTitle.trim();
                    loadAdminMoviesList();
                    showSuccessModal('C·∫≠p nh·∫≠t th√†nh c√¥ng!', 'Th√¥ng tin phim ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t.');
                }
            }
        }

        // Delete movie
        function deleteMovie(movieId) {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a phim n√†y?')) {
                const index = movies.findIndex(m => m.id === movieId);
                if (index > -1) {
                    movies.splice(index, 1);
                    loadAdminMoviesList();
                    document.getElementById('total-movies').textContent = movies.length;
                    showSuccessModal('X√≥a th√†nh c√¥ng!', 'Phim ƒë√£ ƒë∆∞·ª£c x√≥a kh·ªèi h·ªá th·ªëng.');
                }
            }
        }
F
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            loadAdminStats();
            loadRecentBookings();
            loadAdminMoviesList();
        });
    </script>
</body>
</html>